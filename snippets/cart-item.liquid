{%- liquid 
    assign item_product = item.product 

    if class != blank   
        assign class = class
        assign cart_image = 'cart__item-image--' | append: class 
        assign cart_name  =  'cart__item-name--' | append:  class 
        assign cart_details  =  'cart__item-details--' | append: class 
        assign cart_prices  =  'cart__item-prices--' | append: class 
        assign cart_item  =  'cart__item--' | append: class 
        assign item_product = item
    endif
    
    assign item_options = ""

    if item.variant.option1
        assign item_options = item_options | append: item.variant.option1 
    endif

    if item.variant.option2
        assign item_options = item_options | append:  " | " | append: item.variant.option2 
    endif

    if item.variant.option3
        assign item_options = item_options | append:  " | " | append: item.variant.option3 
    endif
    

-%}

<div class="cart__item {{ cart_item }}">
        <div class="cart__item-image {{ cart_image }}">
            <a  class="cart__item-link" href="{{ item.url | within: collections.all }}">
                {%- assign img_url = item | img_url: '250x', crop: 'center' -%}
                <picture class="image-ratio__pic image-ratio__pic--product-item">
                    <img class="image-ratio__img" src="{{ img_url }}" alt="{{ item.title | escape }}">/>
                </picture>
            </a>
        </div>
    
        <div class="cart__item-details {{ cart_details }}">
            <div class="cart__item-prices {{ cart_prices }}">
                {%- if class != blank -%}
                    {% if item.price != item.product_compare_at_price %}
                        <small class="cart__price-compare h5 cart__price-compare--summary">{{ item.price | money }}</small>
                    {% endif %}
                {%- else -%}
                    {% if item.original_line_price != item.line_price %}
                        <small class="cart__price-compare h5">{{ item.original_line_price | money }}</small>
                    {% endif %}
                {%- endif -%}

                <h2 class="cart__price h5">{{ item.final_price | money }}</h2>

                {% assign discounts_size = item.discounts | size %}
                {% if discounts_size > 0 %}
                    {% for discount in item.discounts %}
                        <small class="cart__discount">{{ discount.title }}</small>
                    {% endfor %}
                {% endif %}
            </div>  

            <h4 class="cart__item-name h7 {{ cart_name }}">
                <a href="{{ item.url }}">
                    {%- if class != blank -%}
                        {{ item.title }}
                    {%- else -%}
                        {{ item.product.title }}
                    {%- endif -%}
                </a>
            </h4>

            {%- if item_options != blank -%}
                <p class="cart__item-options">
                    {{ item_options }}
                </p>
            {%- endif -%}

            {% assign property_size = item.properties | size %}
            {% if property_size > 0 %}
                {% for p in item.properties %}
                    {% assign first_character_in_key = p.first | truncate: 1, '' %}
                    {% unless p.last == blank or first_character_in_key == '_' or p.first == 'Minimum Quantity' %}
                        {{ p.first }}:
                        {% if p.last contains '/uploads/' %}
                            <a href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>
                        {% else %}
                            {{ p.last }}
                        {% endif %}
                        <br>
                    {% endunless %}
                {% endfor %}
            {% endif %}

            <div class="cart__item-actions">
                {%- if class != blank -%}
                    {% form 'product', item_product, class: 'js-product-form' %}
                        {%- if item_product.variants.size > 0 -%}
                            <div class="cart__item-variants">
                                <select name="id" class="cart__item-select">
                                    {% for variant in item_product.variants %}
                                        <option value="{{ variant.id }}" {% if variant.id == item.variant_id %}selected{% endif %} {% if variant.available == false %}disabled="disabled"{% endif %}>
                                            {{ variant.title }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <button type="submit" class="button button--purple button--quick-add js-product-form-submit">
                                {{ 'products.product.quick_add' | t }}
                            </button>
                        {%- endif -%}
                        <div class="cart__item-qty pdp__qty cart__item-qty--hidden">
                            <input type="number" name="quantity" id="quantity_{{ item_product.id }}" class="quantity" value="1"/>
                        </div>
                    {% endform %}
                {%- else -%}
                    <div class="cart__item-qty pdp__qty">
                        <input type="number" name="quantity" id="updates_{{ item.key }}" class="quantity" value="{{ item.quantity }}" data-id="{{ item.key }}" />
                    </div>
                {% endif %}
            </div>
            
            {%- if class == blank -%}
                <div class="cart__item-remove">
                    <a href="/cart/change?line={{ index }}&amp;quantity=0" class="button button--icon">
                        <span><i class="icon-close"></i></span>
                    </a>
                </div>
            {% endif %}
        </div>
</div>